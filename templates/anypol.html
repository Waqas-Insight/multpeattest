{% extends "base.html" %}

{% block title %}Policy Page{% endblock %}

{% block content %}
<div class="container" style="min-height: 760px;">
    <!-- this policy-store passes the information from the python flask app to the html for storage, so javascript can access it-->
    <div id="policy-store" value={{info}} style="display:none"></div>
    <div id="policy_div"></div>
</div>

<script>
    //console.log("I can print");
    //console.log(JSON.stringify($('#policy-store').val()));
    //var pol = JSON.parse($('#policy-store').val());
    var pol = {
        "abstract": "Kliimakava tegevussuunad\n1. VÃ¤hendada 2030. aastaks kasvuhoonegaaside heidet 30%, aidates avalikul ja erasektoril ning kodumajapidamistel minna Ã¼le puhtale energiale ja vÃ¤hese sÃ¼sinikusisaldusega kÃ¼tuste kasutamisele.\n2. Toetada taastuvenergia arendamist omavalitsuse korraldustes ja menetlustes.\n3. TÃµsta energiatÃµhusust hoonetes ja elukorralduses vÃ¤hemalt 20%, rakendades omavalitsuse haldusalas (digitaalseid) energiajuhtimissÃ¼steeme ning korrastades hoonefondi kasutust.\n4. TÃ¤iustada liikuvussÃ¼steeme nÃµnda, et vÃ¤hendatakse fossiilsete transpordikÃ¼tuste kasutamist.\n5. Arendada sÃ¼steemselt ringmajandust ning saavutada olmejÃ¤Ã¤tmetes 100% liigiti kogumine.\n6. Talletada sÃ¼sinikku maakasutuslikult ja looduslikult, taastades looduslikkust maastikel ja mÃ¤rgaladel, toetades kestlikku metsandust ja pÃµllumajandust ning vÃµttes kasutusele kliimaneutraalse ja sÃ¼sinikku salvestava maakasutuse planeerimisvahendid.\n7. TÃ¤iendada riskijuhtimist ja tÃµsta valmisolekut kliimariskideks.\n8. Muuta hoiakuid ja suhtumist kliima- ja energiateadlikkuse suunal. ",
        "abstract_english": "Climate Action Plan\n1. Reduce greenhouse gas emissions by 30% by 2030, helping the public and private sectors and households to switch to clean energy and low-carbon fuels.\n2. Support the development of renewable energy in municipal regulations and procedures.\n3. Increase energy efficiency in buildings and living arrangements by at least 20%, by implementing (digital) energy management systems in the municipal area and by improving the use of the building stock.\n4. Improve mobility systems in such a way as to reduce the use of fossil transport fuels.\n5. Systematically develop a circular economy and achieve 100% separate collection of municipal waste.\n6. Store carbon through land use and nature, restoring natural landscapes and wetlands, supporting sustainable forestry and agriculture, and introducing climate-neutral and carbon-storing land use planning tools.\n7. Improve risk management and increase preparedness for climate risks.\n8. Change attitudes and behaviour towards climate and energy awareness.",
        "category": [
            "Climate Action",
            "Energy"
        ],
        "country": "Estonia",
        "data_link": "https://pol.parnumaa.ee/content/editor/files/P%C3%A4rnumaa%20kliimakava%20(20.12.22).pdf",
        "documentation_link": "https://pol.parnumaa.ee/projektid-analuusid/parnumaa-kliimakava-2030",
        "excerpt": "5. Koostada mÃ¤rgalade taastamise nÃ¤idisplaneering turbaalade kasutuseks ja CO2 sidumiseks WaterLANDS projekti raames Lavassaares. Laiendada selle pilootprojekti najal mÃ¤rgalade taastamist. ",
        "excerpt_english": "5. Develop a pilot wetland restoration plan for peatland use and CO2 sequestration in the WaterLANDS project in Lavassaare. Expand wetland restoration based on this pilot project.",
        "id": 270,
        "keywords": [],
        "language": "Estonian / Eesti keel",
        "localauthority": "PÃ¤rnumaa",
        "name": "PÃ¤rnu Climate Plan 2030",
        "nuts_level": false,
        "policy_level": "Local",
        "primary_category": "Climate Action",
        "publisher": [
            "PÃ¤rnu County (PÃ¤rnu maakond)"
        ],
        "publisher_link": false,
        "stakholder_ids": [],
        "toc": "Sissejuhatus ................................................................................................................................................. 20\nKliimakava metoodika ja protsess............................................................................................................... 21\nKasvuhoonegaaside heite baasinventuur (2019) ........................................................................................ 24\nTuule- ja pÃ¤ikeseenergia rajatised (2020) ................................................................................................... 29\nSopi tuulepark (endine Tootsi) - ehitamisel ................................................................................................ 30\nMaismaa tuuleparkide eriplaneeringud - menetluses ................................................................................ 31\nMeretuuleparkide hoonestusloa taotlused - menetluses .......................................................................... 33\nSÃ¼siniku salvestamine maakasutuses ja looduslikult .................................................................................. 35\nKliimamuutus PÃ¤rnumaal ............................................................................................................................ 36\nÃœleujutusrisk ........................................................................................................................................... 41\nKuumasaared .......................................................................................................................................... 44\nKriisivÃµimekus ......................................................................................................................................... 45\nKliimakava rakendamine ............................................................................................................................. 46\nKasutatud lÃ¼hendite ja mÃµistete seletused ................................................................................................ 48 ",
        "toc_english": "Introduction................................................................................................................................................ 20\nClimate Plan Methodology and Process.................................................................................................................. 21\nGreenhouse Gas Emissions Baseline Inventory (2019)............................................................................................... 24\nWind and Solar Energy Facilities (2020)..................................................................................................... 29\nSopi Wind Farm (formerly Tootsi) - under construction................................................................................................ 30\nSpecial plans for onshore wind farms - in process.................................................................................. 31\nOffshore wind farm building permit applications - in process.................................................................................. 33\nCarbon storage in land use and naturally.................................................................................. 35\nClimate change in PÃ¤rnu County............................................................................................................................ 36\nFlood risk............................................................................................................................................ 41\nHeat islands.................................................................................................................................................. 44\nCrisis capacity........................................................................................................................................ 45\nImplementation of the Climate Action Plan.................................................................................................................. 46\nExplanations of abbreviations and terms used.................................................................................................. 48",
        "year_from": "2022",
        "year_to": "2030"
    };
    // defining dictionaries: the formatting of these pills can be found in style.css
    const pillDct = 
        {'Economy': `econ-class-pill`,
        'Land-Use / Agriculture': `land-class-pill`,
        'Environmental quality: water, soil, air':`env-class-pill`,
        'Community and Culture':`comm-class-pill`,
        'Climate':`clm-class-pill`,
        'Energy':`enr-class-pill`,
        'Biodiversity':`bio-class-pill`,
        'Research and applied sciences':`res-class-pill`,
        //
        'Land Use / Agriculture': `land-class-pill`,
        'Climate Action':`clm-class-pill`,
        'Research and Applied Sciences':`res-class-pill`,
        'Environment Quality':`env-class-pill`,
        };
    // this just normalizes the names being used to display in the category pills
    const pillNames = 
        {'Economy': `Economy`,
        'Land-Use / Agriculture': `Land-Use / Agriculture`,
        'Environmental quality: water, soil, air':`Environmental Quality`,
        'Community and Culture':`Community and Culture`,
        'Climate':`Climate`,
        'Energy':`Energy`,
        'Biodiversity':`Biodiversity`,
        'Research and applied sciences':`Research`,
        //
        'Land Use / Agriculture': `Land-Use / Agriculture`,
        'Climate Action':`Climate`,
        'Research and Applied Sciences':`Research`,
        'Environment Quality':`Environmental Quality`,
        };
    // adds countries for flags/levels
    //https://www.alt-codes.net/flags
    const flagmojis = {
        "Global":"ğŸŒ",
        "European":"ğŸ‡ªğŸ‡º",
        "Austria":"ğŸ‡¦ğŸ‡¹",
        "Belgium":"ğŸ‡§ğŸ‡ª",
        "Bulgaria":"ğŸ‡§ğŸ‡¬",
        "Croatia":"ğŸ‡­ğŸ‡·",
        "Cyprus":"ğŸ‡¨ğŸ‡¾",
        "Czech Republic":"ğŸ‡¨ğŸ‡¿",
        "Denmark":"ğŸ‡©ğŸ‡°",
        "Estonia":"ğŸ‡ªğŸ‡ª",
        "Finland":"ğŸ‡«ğŸ‡®",
        "France":"ğŸ‡«ğŸ‡·",
        "Germany":"ğŸ‡©ğŸ‡ª",
        "Greece":"ğŸ‡¬ğŸ‡·",
        "Hungary":"ğŸ‡­ğŸ‡º",
        "Iceland":"ğŸ‡®ğŸ‡¸",
        "Ireland":"ğŸ‡®ğŸ‡ª",
        "Italy":"ğŸ‡®ğŸ‡¹",
        "Latvia":"ğŸ‡±ğŸ‡»",
        "Liechtenstein":"ğŸ‡±ğŸ‡®",
        "Lithuania":"ğŸ‡±ğŸ‡¹",
        "Luxembourg":"ğŸ‡±ğŸ‡º",
        "Malta":"ğŸ‡²ğŸ‡¹",
        "Netherlands":"ğŸ‡³ğŸ‡±",
        "Norway":"ğŸ‡³ğŸ‡´",
        "Poland":"ğŸ‡µğŸ‡±",
        "Portugal":"ğŸ‡µğŸ‡¹",
        "Romania":"ğŸ‡·ğŸ‡´",
        "Slovakia":"ğŸ‡¸ğŸ‡°",
        "Slovenia":"ğŸ‡¸ğŸ‡®",
        "Spain":"ğŸ‡ªğŸ‡¸",
        "Sweden":"ğŸ‡¸ğŸ‡ª",
        "Switzerland":"ğŸ‡¨ğŸ‡­",
        "United Kingdom":"ğŸ‡¬ğŸ‡§"
    }
    // traductions for the word "Overview" in different languages
    const trad_overview = {
        "Austria":"Ãœberblick",
        "Belgium":"AperÃ§u",
        "Bulgaria":"ĞĞ±Ñ‰ Ğ¿Ñ€ĞµĞ³Ğ»ĞµĞ´",
        "Croatia":"Pregled",
        "Cyprus":"Î•Ï€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·",
        "Czech Republic":"PÅ™ehled",
        "Denmark":"Oversigt",
        "Estonia":"Ãœlevaade",
        "Finland":"Yleiskatsaus",
        "France":"AperÃ§u",
        "Germany":"Ãœberblick",
        "Greece":"Î•Ï€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·",
        "Hungary":"ÃttekintÃ©s",
        "Iceland":"Yfirlit",
        "Ireland":"Overview",
        "Italy":"Panoramica",
        "Latvia":"PÄrskats",
        "Liechtenstein":"Ãœbersicht",
        "Lithuania":"ApÅ¾valga",
        "Luxembourg":"Ãœbersicht",
        "Malta":"Ãœbersicht",
        "Netherlands":"Overzicht",
        "Norway":"Oversikt",
        "Poland":"PrzeglÄ…d",
        "Portugal":"VisÃ£o geral",
        "Romania":"Prezentare generalÄƒ",
        "Slovakia":"PrehÄ¾ad",
        "Slovenia":"Pregled",
        "Spain":"Resumen",
        "Sweden":"Ã–versikt",
        "Switzerland":"Ãœbersicht",
        "United Kingdom":"Overview"
    }

    // traductions for the word "Table of Contents" in different languages
    const trad_toc = {
        "Austria":"Inhaltsverzeichnis",
        "Belgium":"Table des matiÃ¨res",
        "Bulgaria":"Ğ¡ÑŠĞ´ÑŠÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ",
        "Croatia":"SadrÅ¾aj",
        "Cyprus":"Î Î¯Î½Î±ÎºÎ±Ï‚ Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Ï‰Î½",
        "Czech Republic":"Obsah",
        "Denmark":"Indholdsfortegnelse",
        "Estonia":"Sisukord", 
        "Finland":"SisÃ¤llysluettelo",
        "France":"Table des matiÃ¨res",
        "Germany":"Inhaltsverzeichnis",
        "Greece":"Î Î¯Î½Î±ÎºÎ±Ï‚ Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Ï‰Î½",
        "Hungary":"TartalomjegyzÃ©k",
        "Iceland":"Efnisyfirlit",
        "Ireland":"Table of Contents",
        "Italy":"Indice",
        "Latvia":"Saturs",
        "Liechtenstein":"Inhaltsverzeichnis",
        "Lithuania":"Turinys",
        "Luxembourg":"Inhaltsverzeichnis",
        "Malta":"Wer",
        "Netherlands":"Inhoudsopgave",
        "Norway":"Innholdsfortegnelse",
        "Poland":"Spis treÅ›ci",
        "Portugal":"Ãndice",
        "Romania":"Cuprins",
        "Slovakia":"Obsah",
        "Slovenia":"Kazalo",
        "Spain":"Ãndice",
        "Sweden":"InnehÃ¥llsfÃ¶rteckning",
        "Switzerland":"Inhaltsverzeichnis",
        "United Kingdom":"Table of Contents"
    };

        // traductions for country names in their native languages
        const trad_countries = {
        "Austria": "Ã–sterreich",
        "Belgium": "Belgique", 
        "Bulgaria": "Ğ‘ÑŠĞ»Ğ³Ğ°Ñ€Ğ¸Ñ",
        "Croatia": "Hrvatska",
        "Cyprus": "ÎšÏÏ€ÏÎ¿Ï‚",
        "Czech Republic": "ÄŒeskÃ¡ republika",
        "Denmark": "Danmark",
        "Estonia": "Eesti",
        "Finland": "Suomi",
        "France": "France",
        "Germany": "Deutschland",
        "Greece": "Î•Î»Î»Î¬Î´Î±",
        "Hungary": "MagyarorszÃ¡g",
        "Iceland": "Ãsland",
        "Ireland": "Ireland",
        "Italy": "Italia",
        "Latvia": "Latvija",
        "Liechtenstein": "Liechtenstein",
        "Lithuania": "Lietuva",
        "Luxembourg": "LÃ«tzebuerg", 
        "Malta": "Malta",
        "Netherlands": "Nederland",
        "Norway": "Norge",
        "Poland": "Polska",
        "Portugal": "Portugal",
        "Romania": "RomÃ¢nia",
        "Slovakia": "Slovensko",
        "Slovenia": "Slovenija",
        "Spain": "EspaÃ±a",
        "Sweden": "Sverige",
        "Switzerland": "Schweiz",
        "United Kingdom": "United Kingdom"
    };

    // traductions for "Policy Document" in different languages
    const trad_policy_document = {
        "Austria": "Politikdokument",
        "Belgium": "Document de la politique",
        "Bulgaria": "ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚",
        "Croatia": "Dokument politike",
        "Cyprus": "ÎˆÎ³Î³ÏÎ±Ï†Î¿ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®Ï‚",
        "Czech Republic": "PolitickÃ½ dokument",
        "Denmark": "Politikdokument",
        "Estonia": "Poliitikadokument",
        "Finland": "Toimintalinjadokumentti",
        "France": "Document de la politique", 
        "Germany": "Politikdokument",
        "Greece": "ÎˆÎ³Î³ÏÎ±Ï†Î¿ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®Ï‚",
        "Hungary": "Politikai dokumentum",
        "Iceland": "StefnumÃ¡laskjal",
        "Ireland": "Policy Document",
        "Italy": "Documento di politica",
        "Latvia": "Politikas dokuments",
        "Liechtenstein": "Politikdokument",
        "Lithuania": "Politikos dokumentas",
        "Luxembourg": "Politikdokument",
        "Malta": "Dokument tal-Politika",
        "Netherlands": "Beleidsdocument",
        "Norway": "Policy Dokument",
        "Poland": "Dokument polityczny",
        "Portugal": "Documento de polÃ­tica",
        "Romania": "Document de politicÄƒ",
        "Slovakia": "PolitickÃ½ dokument",
        "Slovenia": "Dokument politike",
        "Spain": "Documento de polÃ­tica",
        "Sweden": "Policydokument",
        "Switzerland": "Politikdokument",
        "United Kingdom": "Policy Document"
    };

    // traductions for "Policy Info Page" in different languages
    const trad_policy_info_page = {
        "Austria": "Politikinformationsseite",
        "Belgium": "Page d'information sur la politique",
        "Bulgaria": "Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ·Ğ° Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°Ñ‚Ğ°",
        "Croatia": "Stranica s informacijama o politici",
        "Cyprus": "Î£ÎµÎ»Î¯Î´Î± Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®Ï‚",
        "Czech Republic": "InformaÄnÃ­ strÃ¡nka o politice",
        "Denmark": "Informationsside om politik",
        "Estonia": "Poliitika infoleht",
        "Finland": "Toimintalinjan infosivu",
        "France": "Page d'information sur la politique",
        "Germany": "Politikinformationsseite",
        "Greece": "Î£ÎµÎ»Î¯Î´Î± Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®Ï‚",
        "Hungary": "Politikai informÃ¡ciÃ³s oldal",
        "Iceland": "UpplÃ½singasÃ­Ã°a stefnu",
        "Ireland": "Policy Info Page",
        "Italy": "Pagina info politica",
        "Latvia": "Politikas informÄcijas lapa",
        "Liechtenstein": "Politikinformationsseite",
        "Lithuania": "Politikos informacijos puslapis",
        "Luxembourg": "Page d'information sur la politique",
        "Malta": "PaÄ¡na ta' Informazzjoni dwar il-Politika",
        "Netherlands": "Beleidsinfopagina",
        "Norway": "Informasjonsside for policy",
        "Poland": "Strona informacyjna polityki",
        "Portugal": "PÃ¡gina de informaÃ§Ã£o da polÃ­tica",
        "Romania": "PaginÄƒ de informaÈ›ii despre politicÄƒ",
        "Slovakia": "InformaÄnÃ¡ strÃ¡nka politiky",
        "Slovenia": "Stran s podatki o politiki",
        "Spain": "PÃ¡gina de informaciÃ³n de la polÃ­tica",
        "Sweden": "Policysida",
        "Switzerland": "Page d'information sur la politique",
        "United Kingdom": "Policy Info Page"
    };


    // how to display policies
    function policyShow(policy, currentLang = 'english'){
        console.log(policy);
        const polPop = $('#policy_div');
        polPop.html('');

        // categories html, gets all categories in their pill form
        var categ_coll = [`<p class="badge rounded-pill ${ pillDct[policy["primary_category" ]] }" style="font-size:17px">${ pillNames[policy["primary_category"]] }</p>`];
        var categ_lst = policy["category"].sort();
        if(categ_lst.length > 1){
            categ_coll.push(`|`);
        }
        for (let c=0; c < categ_lst.length; c++){
            if(categ_lst[c] != policy["primary_category"]){
                categ_coll.push(`<p class="badge rounded-pill ${ pillDct[categ_lst[c]] }" style="font-size:17px">${ pillNames[categ_lst[c]] }</p>`);
            }
        }
        var categs_html = categ_coll.join(" ");

        // publishers html, gets all publishers
        var publs_coll = [];
        policy["publisher"].forEach(publisher =>
            publs_coll.push(`<p class="d-inline">${publisher}</p>`)
        );
        var publs_html = publs_coll.join(`; <p class="d-inline" style="font-size:14px">ğŸ‘¤</p><p class="d-inline">`);

        // level / sublevel html, accounts for global and european, adds emojis
        var lvl_area_html = ``;
        var name_country_english= policy['country'];
        var name_country_native= trad_countries[policy['country']];

        let name_country_to_display = (currentLang === 'english') ? name_country_english : name_country_native;

        if(["European", "Global"].includes(policy['policy_level'])){
            lvl_area_html = `<p class="d-inline" style="font-size:25px">${ flagmojis[policy['policy_level']] }</p> <p class="d-inline">${ policy['policy_level'] } </p>`;
        }else{
            if(policy["country"] in flagmojis){
                lvl_area_html = `<p class="d-inline" style="font-size:25px">${ flagmojis[name_country_english] }</p> <p class="d-inline" style="font-size:25px">${name_country_to_display} | ${ policy['policy_level'] } </p>`;
            }else{
                lvl_area_html = `<p style="font-size:25px"> ${ name_country_to_display } | ${ policy['policy_level'] } </p>`;
            }
        }

        // duration html, accounts for missing dates
        var duratn_html = ``;
        if(policy['year_from'] && policy['year_to']){
            duratn_html = `${policy['year_from']}-${policy['year_to']}`;
        }else{
            if(policy['year_from']){
                duratn_html = `${policy['year_from']}-`;
            }else if(policy['year_to']){
                duratn_html = `-${policy['year_to']}`;
            }
        }

        // excerpt html
        var excerpt_html_english = `<p class="excerpt-text"> ${policy['excerpt_english']}</p>`;
        var excerpt_html_native = `<p class="excerpt-text"> ${policy['excerpt']}</p>`;

        let excerpt_html_to_display = (currentLang === 'english') ? excerpt_html_english : excerpt_html_native;

        // try to split abstract by \n to retain line breaks?
        var abst_sents_english = policy['abstract_english'].split("\n");
        var abst_ps_english = [];
        abst_sents_english.forEach(sentence =>
            abst_ps_english.push(`<p class="poltxt">${ sentence }</p>`)
        );
        var abst_html_english = abst_ps_english.join(`<p style="margin-bottom:10px;"></p>`);
        var abst_html_section_english = `<div>
                                    <h3 class="section-title-container"><div class="section-title-box">Overview</div></h3>
                                    <div style="margin-bottom:10px">
                                        ${ abst_html_english }
                                    </div>
                                </div>`

        var abst_sents_native = policy['abstract'].split("\n");
        var abst_ps_native = [];
        abst_sents_native.forEach(sentence =>
            abst_ps_native.push(`<p class="poltxt">${ sentence }</p>`)
        );
        var abst_html_native = abst_ps_native.join(`<p style="margin-bottom:10px;"></p>`);
        var abst_html_section_native = `<div>
                                    <h3 class="section-title-container"><div class="section-title-box">${trad_overview[policy['country']]}</div></h3>
                                    <div style="margin-bottom:20px">
                                        ${ abst_html_native }
                                    </div>
                                </div>`

        let abst_html_section_to_display = (currentLang === 'english') ? abst_html_section_english : abst_html_section_native;

        // split table of contents by \n to retain line breaks
        var toc_html_english = ``;
        var toc_html_section_english = ``;
        if(policy['toc_english']){
            var toc_lines_english = policy['toc_english'].split("\n");
            var toc_ps_english = [];
            toc_lines_english.forEach(line =>
                toc_ps_english.push(`<p class="poltxt">${ line }</p>`)
            );
            toc_html_english = toc_ps_english.join(`<p style="margin-bottom:10px;"></p>`);
            toc_html_section_english = `<div>
                                    <h3 class="section-title-container"><div class="section-title-box">Table of Contents</div></h3>
                                    <div style="margin-bottom:20px">
                                        ${ toc_html_english }
                                    </div>
                                </div>`
        }

        var toc_html_native = ``;
        var toc_html_section_native = ``;
        if(policy['toc']){
            var toc_lines_native = policy['toc'].split("\n");
            var toc_ps_native = [];
            toc_lines_native.forEach(line =>
                toc_ps_native.push(`<p class="poltxt">${ line }</p>`)
            );
            toc_html_native = toc_ps_native.join(`<p style="margin-bottom:10px;"></p>`);
            toc_html_section_native = `<div>
                                    <h3 class="section-title-container"><div class="section-title-box">${trad_toc[policy['country']]}</div></h3>
                                    <div style="margin-bottom:20px">
                                        ${ toc_html_native }
                                    </div>
                                </div>`
        }

        let toc_html_section_to_display = (currentLang === 'english') ? toc_html_section_english : toc_html_section_native;
           
        // create button to switch between languages
        var button_native=`<button data-lang="native" class="btn btn-outline-dark" style="font-size:14px" >${ flagmojis[policy['country']] } ${ policy['language']}</button>`
        var button_english=`<button data-lang="english" class="btn btn-outline-dark" style="font-size:14px" >${ flagmojis['United Kingdom'] } English</button>`
        
        // links
        var name_link_doc_english = 'Policy Document'
        var name_link_doc_native = trad_policy_document[policy['country']];
        let name_link_doc_to_display = (currentLang === 'english') ? name_link_doc_english : name_link_doc_native;

        var name_link_info_english = 'Policy Info Page'
        var name_link_info_native = trad_policy_info_page[policy['country']];
        let name_link_info_to_display = (currentLang === 'english') ? name_link_info_english : name_link_info_native;

        var links_html = `<div style="margin-top:10px;margin-bottom:10px;">
                    <a href="${ policy['data_link'] }" class="polcol-lnk d-inline" target="_blank">
                        ${name_link_doc_to_display}
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
                        </svg>
                        </a> | 
                    <a href="${ policy['documentation_link'] }" class="polcol-lnk d-inline" target="_blank">${name_link_info_to_display} â†—</a>
                    </div>`;
        
        // element to append to the policy           
        var element = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;margin-top:5px;">
                        <div style="margin-top:3px">
                            ${categs_html}
                        </div>    
                            <div style="margin-top:3px">
                                <p class="d-inline" style="font-size:16px">ğŸ‘¤</p> ${publs_html}
                            </div>
                            <div id="lang-btns">
                                ${button_native}
                                ${button_english}
                            </div>  
                               
                    </div>
                    <h1 id="pol-res-he" class="policy-name-header">${policy["name"]}</h1>
                    <div>
                        ${lvl_area_html}
                        <p class="d-inline" style="font-size:25px"> | ${duratn_html} </p>
                    </div> 
                    <div id="excerpt-content">
                        ${excerpt_html_to_display}
                    </div>
                    <div style="display: flex; align-items: flex-start; gap: 20px;">
                        <div style="flex: 1; padding-right: 20px;">
                            <div id="abstract-content">  
                                ${abst_html_section_to_display}
                            </div>
                            <div id="toc-content">        
                                ${toc_html_section_to_display}
                            </div>
                        </div>
                
                        <div>
                            <div class="pdf-viewer-container">
                                <iframe src="${policy['data_link']}" class="pdf-iframe"></iframe>
                            </div>
                            <div align=center>
                                ${links_html}
                            </div>
                        </div>
                    </div>
                    
                    `;

        polPop.append(element);
        if(!policy){
            polPop.append(`<p class="text-center" style="color:black;">Policy not found.</p>`);
        }

        // add event listeners to the buttons
        document.querySelectorAll('#lang-btns button').forEach(button => {
            button.addEventListener('click', () => {
                const lang = button.getAttribute('data-lang');
                policyShow(policy, lang); // Rappeler policyShow avec la nouvelle langue
        });
    });
    }
    policyShow(pol, 'english');
</script>

{% endblock %}