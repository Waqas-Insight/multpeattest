{% extends "base.html" %}

{% block title %}Map{% endblock %}

{% block head %}
<!-- Add Font Awesome for icons -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
{% endblock %}

{% block navbar %}
<nav class="navbar navbar-expand bg-body-tertiary">
    <div class="container-fluid d-flex justify-content-between" style="padding:0px; padding-left: 8px; margin-left: 12px; margin-top: 15px; margin-bottom: 50px;">
        <div class="d-flex align-middle">
            <a class="navbar-brand d-inline-block" href="https://multipeat.org/en?domain=https://multipeat.insight-centre.org/map" style="padding:0px">
                <img src="{{url_for('static', filename='multipeat_logo.png')}}" alt="Logo" width="50" height="40" class="align-middle" style="padding-right: 5px;">
            </a>
            <a class="navbar-brand d-inline-block" href="https://aspect-unit.multipeat.insight-centre.org/?domain=https://multipeat.insight-centre.org/map" style="padding:0px">
                <img src="{{url_for('static', filename='ASPECT_logo.png')}}" alt="Logo" width="75" height="40" class="align-middle" style="padding-right: 10px;">
            </a>
            <div class="d-inline-block align-middle">
                <a class="navbar-brand d-inline-block" href="{{url_for('landingpage')}}" style="padding:0px">
                    <h3 class="d-inline-block" style="margin-right: 2px;">Peatland Policy</h3> <h3 style="color: #9fbbcf; font-weight: bold;" class="d-inline-block">Portal</h3>
                    <p class="d-block" style="font-size: small; margin-top: -7px;">Advancing capabilities to measure and regenerate wetlands</p>
                </a>
            </div>
        </div>
        <div class="d-inline-flex align-middle justify-content-end" style="margin-right: 0px;">
            {% include 'includes/user-menu.html' %}
        </div>
    </div>
    <div style="background-color: #9fbbcf; height: 40px; width: 100%;" class="position-absolute bottom-0">
        <div style="padding-top: 0px;" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="nav-item">
                    <a class="nav-link on-page" href="{{ url_for('map_page') }}" style="padding: 7px; margin-left: 15px; font-weight: bold;">SITES & POLICIES</a>
                </li>
                <div style="border-right: 1px solid #747474; height: 25px; padding: 0px 10px; align-self: center;"></div>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" style="padding: 7px; margin-left: 15px; font-weight: bold;" aria-expanded="false">USE THE TOOLS</a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{{ url_for('ffp_tool') }}">Financial Feasibility Tool</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('set_tool') }}">Site Emissions Tool</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="{{ url_for('policy') }}">Policy Collection</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('qa_tool') }}">Policy Discovery</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('policy_keywords') }}">Policy Keywords</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('stakeholders') }}">Stakeholder Collection</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('sub_policy') }}">Suggest a Policy</a></li>
                        <li><a class="dropdown-item disabled" href="#">Policy Analyser</a></li>
                    </ul>
                </li>
                <div style="border-right: 1px solid #747474; height: 25px; padding: 0px 10px; align-self: center;"></div>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('about') }}" style="padding: 7px; margin-left: 15px; font-weight: bold;">ABOUT US</a>
                </li>
                <div style="border-right: 1px solid #747474; height: 25px; padding: 0px 10px; align-self: center;"></div>
            </ul>
        </div>
    </div>
</nav>
{% endblock %}

<!-- Include User Modals -->
{% include 'includes/user-modals.html' %}

<script src="{{ url_for('static', filename='scripts/logout_template.js') }}"></script>

{% block content %}
<div class="container-fluid" style="padding:0px; margin:0px;height:100vh; position:relative">
    <div id="map"></div>
    <!--map page buttons-->
    <button id="map-layers-btn">
        <svg id="map-layers-svg" height="50" width="50" style="position: absolute; top: 75px; left: 0;" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Map Layers">
            <image xlink:href="{{ url_for('static', filename='geo-alt.svg') }}" style="height:40px; width:40px;"></image>
        </svg>
    </button>
    <button id="map-data-btn">
        <svg id="map-data-svg" height="50" width="50" style="position: absolute; top: 350px; left: 0;" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Data Vis. (not in use yet)">
            <image xlink:href="{{ url_for('static', filename='bar-chart-line.svg') }}" style="height:40px; width:40px;"></image>
        </svg>
    </button>
    <button id="map-pol-btn">
        <svg id="map-pol-svg" height="50" width="50" style="position: absolute; top: 50px; right: 0;" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Policy List">
            <image xlink:href="{{ url_for('static', filename='file-earmark-text.svg') }}" style="height:40px; width:40px;"></image>
        </svg>
    </button>
    <button id="map-pol-cls-btn">
        <svg id="map-pol-cls-svg" width="50" height="50" fill="white" style="position: absolute; top: 105px; right: 400px; display:none;" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Policy Categories">
            <image xlink:href="{{ url_for('static', filename='list-task.svg') }}" style="height:40px; width:40px;"></image>        
        </svg>
    </button>
    
    <!--layer box-->
    <div id="map-lyr-box" style="position: absolute; top: 60px; left: 0; width:200px; display:none;">
        <p style="font-weight: bold; color: #747474; margin-left: 5px;">SITE TYPES</p>
        <div id="layers-div" class="overflow-auto" style="padding-left: 10px; max-height: 400px;">
            <div id="int-lyr-div">
                <div id="int-lyr-tog" class="row d-flex justify-content-start">
                    <div class="col-1">
                        <svg id="int-lyr-tog-up" height="20" width="20" style="display: block;">
                            <image style="height:20px; width:20px" xlink:href="{{ url_for('static', filename='chevron-up.svg') }}"></image>
                        </svg>
                        <svg id="int-lyr-tog-down" height="20" width="20" style="display: none;">
                            <image style="height:20px; width:20px" xlink:href="{{ url_for('static', filename='chevron-down.svg') }}"></image>
                        </svg>
                    </div>
                    <div class="col" style="padding-left: 10px;">
                        <p class="lyr-reg-txt">International</p>
                    </div>
                </div>
                <div id="int-lyr-lyrs" style="padding-left: 10px; display: block"></div>
            </div>
            <!-- Add your other country divs here -->
        </div>
    </div>
    
    <!--policy box-->
    <div id="map-pol-box" style="position: absolute; top: 0; right: 0; width:400px; min-height: 150px; display:none;">
        <div id="map-pol-default" class="row">
            <p style="font-weight: bold; color: #747474; margin-left: 5px;">Policy Information</p>
            <p style="color: #747474; margin-left: 5px;">Click on the map to view relevant policies.</p>
        </div>
        <!--policy box level selection buttons-->
        <div id="lvl-filter-div" class="d-inline-flex">
            <p style="color: #747474; margin-left: 5px;">Levels:</p>
            <label style="margin-left: 5px;">
                <input type="checkbox" id="locauth-fltr" style="display: none;" value="" checked/>
                <svg id="locauth-fltr-svg" xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-house-door-fill" viewBox="0 0 16 16" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Local Policies">
                    <path d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5"/>
                </svg>
            </label>
            <!-- Add your other filter labels here -->
        </div>
        <!--Where policies populate-->
        <div id="map-pols-div" style="margin: 5px; min-height: 75px; max-height:500px; overflow:auto;">
            <div id="coun-pol"></div>
            <div id="reg-pol"></div>
            <div id="nat-pol"></div>
            <div id="eu-pol"></div>
            <div id="glob-pol"></div>
            <div id="offc-no-features"></div>
        </div>
        <!-- hidden inputs -->
        <input id="policy-request-store" style="display: none;" value="{{ [] }}">
        <input id="eustat-request-store" style="display: none;" value="">
    </div>
    
    <!--policy class box-->
    <div id="map-pols-cls-div" style="position: absolute; top: 105px; right: 400px; width:150px; display:none;">
        <!-- Add your policy class checkboxes here -->
    </div>
</div>

<!--Popup div-->
<div id="popup" class="ol-popup">
    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
    <div id="popup-content">
        <div id="bog-info"></div>
        <div id="PS-info"></div>
        <div id="ie-info"></div>
        <!-- Add your other info divs here -->
        <div id="no-features"></div>
    </div>
</div>

<script type="module" src="{{url_for('static', filename='scripts/Map.js')}}" ></script>
<script type="module" src="{{url_for('static', filename='scripts/customFunctions.js')}}" ></script>
<script type="module" src="{{url_for('static', filename='scripts/Identify.js')}}" ></script>
<script type="module" src="{{url_for('static', filename='scripts/Layers.js')}}" ></script>
<script type="module" src="{{url_for('static', filename='scripts/Search.js')}}" ></script>
<script type="module" src="{{url_for('static', filename='scripts/Offcanv.js')}}"></script>

<!-- Include User Menu JavaScript -->
{% include 'includes/user-menu-scripts.html' %}

<script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
</script>
{% endblock %}